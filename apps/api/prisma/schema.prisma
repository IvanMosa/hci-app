// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum UserType {
  freelancer
  client
}

enum JobStatus {
  active
  completed
}

enum JobCategory {
  web_development
  design
  writing
  marketing
  data_science
  other
}

model User {
  id           String      @id @default(uuid())
  name         String
  surname      String
  email        String      @unique
  password     String
  type         UserType
  dateOfBirth  DateTime
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @default(now())
  
  freelancerProfile FreelancerProfile?
  jobs             Job[]    @relation("ClientJobs")
}

model FreelancerProfile {
  id         String  @id @default(uuid())
  userId     String  @unique
  bio        String?
  location   String?
  hourlyRate Decimal?

  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  skills     FreelancerSkill[]
  portfolio  Portfolio[]
  applications Application[]
}

model Skill {
  id      String             @id @default(uuid())
  name    String             @unique

  freelancers FreelancerSkill[]
}

model FreelancerSkill {
  freelancerId String
  skillId      String

  freelancer   FreelancerProfile @relation(fields: [freelancerId], references: [id], onDelete: Cascade)
  skill        Skill             @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@id([freelancerId, skillId])
}

model Portfolio {
  id           String  @id @default(uuid())
  freelancerId String
  title        String
  description  String?
  url          String?

  freelancer   FreelancerProfile @relation(fields: [freelancerId], references: [id], onDelete: Cascade)
}

model Job {
  id        String      @id @default(uuid())
  clientId  String
  title     String
  description String
  category  JobCategory?
  budget    Decimal?   
  status    JobStatus   @default(active)
  createdAt DateTime    @default(now())
  updatedAt DateTime    @default(now())

  client       User          @relation("ClientJobs", fields: [clientId], references: [id], onDelete: Cascade)
  applications Application[]

  @@index([status])
  @@index([category])
  @@index([status, category])
}

model Application {
  id           String  @id @default(uuid())
  jobId        String
  freelancerId String
  proposal     String?
  bidAmount    Decimal? 
  createdAt    DateTime @default(now())

  job         Job             @relation(fields: [jobId], references: [id], onDelete: Cascade)
  freelancer  FreelancerProfile @relation(fields: [freelancerId], references: [id], onDelete: Cascade)
}